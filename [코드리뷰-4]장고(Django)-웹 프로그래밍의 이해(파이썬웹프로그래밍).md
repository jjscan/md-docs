## 파이썬 웹프로그래밍 - Django로 배우는 웹 개발
### Chapter 01 - 웹 프로그래밍의 이해

#### 1.1 웹 프로그래밍이란?
 웹 프로그래밍이란 간단히 말하면 HTTP(S) 프로토콜로 통신하는, 클라이언 트와 서버를 개발하는 것입니다.
 웹 클라이언트와 웹 서버를 같이 개발할 수도 있고, 웹 클라이언트 또는 웹 서버 하나만 개발할 수도 있습니다.
 보통은 웹 서버를 개발하는 경우가 많아서 파이썬 웹 프로그래밍이라고 하면 우선적으로 장고(Django)와 같은 웹 프레임워크를 사용하여 웹 서버를 개발하는 것을 떠올리게 됩니다.
 웹 클라이언트는 웹 브라우저가 많이 사용되고, 비슷한 원리로 리눅스 curl 명령 또는 Telnet을 사용하여 요청하거나 직접 만든 클라이언트로 요청하게 됩니다.
#### 1.2 HTTP 프로토콜
**HTTP 메시지의 구조**
 HTTP 메시지는 클라이언트에서 서버로 보내는 요청 메시지(request)와 서버에서 클라이언트로 보내는 응답 메시지(response)가 있습니다.
 스타드라인(Start Line) : 요청라인 또는 상태라인
 헤더(Header) : 헤더는 생략 가능
 빈줄(Black Line) : 헤더의 끝을 빈 줄로 식별
 바디(Body) : 바디는 생략 가능

바디가 없는 요청 메시지의 예시
 GET /book/shakespeare HTTP/1.1 --- 요청라인
 요청방식(Method) / 요청URL / 프로토콜버전
 Host: `www.example.com:8080` --- 헤더
 이름 : 값 형식으로 표현

**URI과 URL이란?**
 URI는 Uniform Resource Indentifier의 약자로 URL과 URN을 포함한다.
 URL은 Uniform Resource Locator의 약자다.
 웹 프로그래밍에서는 URI와 URL을 동일한 의미로 사용해도 무방하다.

**HTTP 처리 방식**
 HTTP 메소드(Method)를 통해서 클라이언트가 원하는 처리 방식을 서버에 알려줍니다. 많이 사용되는 메소드를 GET, POST, PUT, DELETE 4개의 메소드이며, 데이터 조작의 기본이 되는 CRUD(CREATE, READ, UPDATE, DELETE)와 매핑되는 처리를 합니다.

 GET 방식은 지정한 URL의 정보를 가져오는 메소드
 POST 방식에 대표적인 기능은 리소스를 생성하는 메소드
 PUT 방식은 리소스를 변경하는 메소드
 DELETE 방식은 리소스를 삭제하는 메소드
 (**POST와 PUT의 용도를 구분하는 것이 엄밀하게 지켜지지 않는다.**)

 GET 방식은 URL 부분의 `?` 뒤에 `이름=값` 쌍으로 이어붙여 보낸다.
 POST 방식은 GET에서 URL에 포함시켰던 파라미터들을 요청 메시지의 바디(BODY)에 넣는다.
 GET 방식은 전달하는 데이터가 웹 브라우저 주소창에 노출된다는 단점과 URL은 길이제한이 있다는 단점이 있다. POST 방식은 이를 보완할 수 있다.

**HTTP 상태 코드**
 1xx - 정보제공(informational)
 2xx - 성공(success)
 3xx - 리다이렉션(redirection)
 4xx - 클라이언트 에러(client error)
 5xx - 서버 에러(server error)

#### 1.3 URL 설계
 웹 애플리케이션을 개발할 때, 고객의 요구사항이 정리되면 먼저 디자인 측면에서는 화면 UI를 설계하고, 프로그램 로직 측면에서는 URL을 설계하게 됩니다. 전체 프로그램 로직을 생각하면서 차후에 로직이 변경되더라도 URL 변경은 최소화할 수 있도록 유연하게 설계하는 것이 중요합니다.

| <http://> | [www.example.com](http://www.example.com/) | :8080    | /services? | category=2&kind=patents | #n10       |
| --------- | ------------------------------------------ | -------- | ---------- | ----------------------- | ---------- |
| URL스킴   | 호스트명                                   | 포트번호 | 경로       | 쿼리스트링              | 프라그먼트 |


URL 스킴 : URL에 사용된 프로토콜을 의미
호스트명 : 웹 서버의 호스트명으로, 도메인명 또는 IP 주소로 표현
포트번호 : 웹 서버 내의 서비스 포트번호. 생략 시에는 디폴트 포트번호로 hppt는 80, https는 443을 사용
경로 : 파일이나 애플리케이션 경로를 의미
쿼리스트링 : 질의 문자열로, &로 구분된 `이름=값`쌍 형식으로 표현
프라그먼트 : 문서 내의 앵커 등 조각을 지정

**URL을 바라보는 측면**
 RPC(Remote Procedure Call) : 클라이언트가 네트워크상에서 원격에 있는 서버가 제공하는 API 함수를 호출하는 방식
  `http://blog.example.com/search?q=test&debug=true`

 REST(Representational State Transfer) : 웹 서버에 존재하는 요소들을 모두 리소스라고 정의하고, URL을 통해 웹 서버의 특정 리소스를 표현한다는 개념. 리소스는 시간이 지남에 따라 상태(state)가 변할 수 있기 때문에 클라이언트와 서버 간의 데이터의 교환을 리소스 상태(Representational State Transfer)의 교환으로 간주하고 있다. 그리고 중요한 점은 리소스에 대한 조작을 GET, POST, PUT, DELETE 등의 HTTP 메소드로 구분한다는 점이다.
  `http://blog.example.com/search/test`

 간편 URL
위에서 설명한 REST 방식의 URL 개념을 기반으로, 간단하면서도 사용자에게 친숙하게 URL을 표현하는 방법. 쿼리스트링 없이 경로만 가진 간단한 구조의   `http://example.com/products/25`

 파이썬의 우아한 URL
 파이썬 프레임워크에서는 처음부터 간편 URL 체계를 도입했고, 그 외에도 URL을 정의하기 위해 정규표현식(Regular Expression)을 추가적으로 사용할 수 있다.
 ```
 urlpatterns = [
     path('articles/2003/', views,special_case_2003),
     re_path('article/<int:year>/', views.year_archive),
     re_path('articles/<int:year>/<int:month>/', views.month_archive),
 ]
 ```
 정규표현식을 사용하여 URL을 좀 더 구체적으로 작성하면 아래처럼 됩니다.
 `re_path(r'^articles/(?P<year>[0-9]{4})/$', views.year_archive)`

#### 1.4 웹 애플리케이션 서버
 웹 클라이언트의 요청을 받아서 처리하는 서버를 통칭하여 웹 서버라고 부르기도 하지만, 좀 더 세분화하면 웹 서버와 웹 애플리케이션 서버로 분류할 수 있습니다. 웹 서버는 주로 정적인 페이지를 담당하고, 웹 애플리케이션 서버는 동적 페이지 요청을 받아서 처리합니다.

 필요한 데이터를 저장하고 꺼내오는 등의 데이터베이스 처리에 대한 요구가 많아짐에 따라 웹 서버와는 다른 별도의 프로그램이 필요하게 되었고, 이러한 별도의 프로그램과 웹 서버 사이에 정보를 주고받는 규칙을 정의한 것이 바로 CGI(Common Gateway Interface) 규격입니다.

**CGI 방식의 단점**
 CGI 자체는 정식 프로그래밍 언어나 스크립트가 아니라, 웹 서버와 독립적인 프로그램(프로세스) 사이에 정보를 주고받는 규격을 의미하며, 이 규격을 준수하면 어떤 언어를 사용해도 CGI 프로그램을 개발할 수 있습니다.
 CGI 방식의 근본적인 문제점은 각각의 클라이언트 요청에 대하여 독립적인 별도의 프로세스가 생성된다는 것입니다. 요청이 많아질수록 프로세스가 많아지고, 프로세스가 많아질수록 비례적으로 프로세스가 점유하는 메모리 요구량도 커져서 시스템에 많은 부하를 주는 요인이 됩니다. 이러한 이유로 현재는 CGI 방식을 거의 사용하지 않고 있습니다.

**CGI 방식의 대안 기술**
 첫 번째 방법
 별도의 애플리케이션을 perl, PHP 등의 스크립트 언어로 작성하고, 스크립트를 처리하는 스크립트 엔진(인터프리터)을 웹 서버에 내장시켜서 CGI 방식의 단점이었던 별도의 프로세스를 기동시키는 오버헤드를 줄이는 방식입니다. 

 두 번째 방법
 애플리케이션을 처리하는 프로세스를 미리 데몬으로 가동시켜 놓은 후, 웹 서버의 요청을 데몬에서 처리하는 것입니다. 이 또한 프로세스 생성 부하를 줄일 수 있는 방법입니다.

 파이썬의 경우에는 mod_wsgi 모듈을 사용하고 웹 서버 내장 방식 또는 데몬 방식으로 모두 실행 가능합니다.

 

